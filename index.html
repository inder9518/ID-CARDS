<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Race Mate ID - Mobile Ready</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&family=Inter:wght@400;500;600&display=swap');

        * { box-sizing: border-box; }

        body {
            background-color: #f1f5f9;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 40px;
            min-height: 100vh;
        }

        /* --- CONTROL PANEL --- */
        .control-panel {
            background: white; padding: 20px; border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); width: 320px; border: 1px solid #e2e8f0;
            flex-shrink: 0; /* Prevent shrinking */
        }
        .input-group { margin-bottom: 8px; }
        .input-group label { display: block; font-size: 11px; font-weight: 600; color: #64748b; margin-bottom: 2px;}
        .input-group input, .input-group select, .input-group textarea { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 14px; font-family: inherit; }
        .input-group textarea { resize: vertical; height: 50px; }

        .section-title { font-size: 12px; font-weight: bold; color: #0f172a; margin-top: 15px; margin-bottom: 5px; border-bottom: 1px solid #eee; padding-bottom: 3px; }

        .btn-update { background: #0f172a; color: white; width: 100%; padding: 12px; border: none; border-radius: 5px; cursor: pointer; margin-top: 15px; font-size: 14px; }
        .btn-print { background: #ea580c; color: white; width: 100%; padding: 12px; border: none; border-radius: 5px; cursor: pointer; margin-top: 8px; font-weight: bold; font-size: 14px; }

        /* --- CARD DESIGN --- */
        .card-wrapper { 
            transform: scale(1.3); 
            transform-origin: top center; 
            flex-shrink: 0;
        }

        .card {
            width: 5.4cm; 
            height: 8.5cm;
            background: #ffffff;
            border-radius: 0.3cm; 
            position: relative; 
            overflow: hidden;
            display: flex; 
            flex-direction: column; 
            border: 1px solid #e2e8f0;
            -webkit-print-color-adjust: exact !important; 
            print-color-adjust: exact !important;
        }

        /* Header */
        .header {
            position: relative; z-index: 2; text-align: center;
            padding-top: 0.5cm; height: 1.6cm; 
            display: flex; justify-content: center; align-items: center;
            background: white;
        }
        .logo { max-width: 3.8cm; max-height: 1.1cm; object-fit: contain; }

        /* Photo */
        .photo-wrapper {
            position: relative; z-index: 2; display: flex; justify-content: center; margin-top: 0.1cm;
        }
        .photo-frame {
            width: 2.3cm; height: 2.3cm; 
            background: white;
            padding: 0.1cm; border-radius: 0.2cm; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        .photo { width: 100%; height: 100%; object-fit: cover; border-radius: 0.15cm; }

        /* Content */
        .content { text-align: center; margin-top: 0.2cm; padding: 0 0.3cm; color: #1e293b; z-index: 2; flex-grow: 1;}
        .name { font-family: 'Exo 2', sans-serif; font-size: 10pt; font-weight: 700; color: #0f172a; margin-bottom: 0px; text-transform: uppercase; line-height: 1.2; }
        .role-badge { display: inline-block; background: #e0f2fe; color: #0284c7; padding: 0.05cm 0.3cm; border-radius: 0.3cm; font-size: 5pt; font-weight: 700; text-transform: uppercase; margin-bottom: 0.15cm; margin-top: 1px;}

        /* Grid Layout */
        .info-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 0.1cm;
            text-align: left; background: #f8fafc; padding: 0.15cm;
            border-radius: 0.2cm; border: 0.5px solid #f1f5f9;
        }
        .info-item { display: flex; flex-direction: column; }
        .label { font-size: 4pt; color: #64748b; text-transform: uppercase; font-weight: 600; }
        .value { font-size: 6.5pt; color: #334155; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Footer */
        .footer-bg {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 1.4cm; 
            background: linear-gradient(120deg, #1e293b 0%, #0f172a 100%);
            z-index: 0;
        }

        .footer {
            margin-top: auto; padding: 0.1cm 0.3cm;
            display: flex; justify-content: space-between; align-items: center;
            height: 1.4cm; 
            position: relative; z-index: 2;
            color: white;
        }
        
        .qr-box { background: white; padding: 1px; border-radius: 2px; display: flex; }
        .qr-img { width: 0.9cm; height: 0.9cm; }

        .company-details {
            text-align: right; display: flex; flex-direction: column; justify-content: center; align-items: flex-end;
        }
        .company-name { 
            font-size: 5.5pt; font-weight: 800; color: #ffffff; margin-bottom: 2px; text-transform: uppercase; letter-spacing: 0.5px;
        }
        .company-address { 
            font-size: 4pt; font-weight: 700; color: #e2e8f0; line-height: 1.2; max-width: 3.0cm; white-space: pre-wrap; margin-bottom: 0;
        }

        /* --- MOBILE OPTIMIZATION --- */
        @media screen and (max-width: 768px) {
            body {
                flex-direction: column; /* Stack items vertically */
                align-items: center;
                padding: 10px;
                gap: 20px;
            }

            .card-wrapper {
                order: 1; /* Show Card First */
                transform: scale(1.1); /* Slightly smaller scale for phone */
                margin-bottom: 10px;
                /* Sticky positioning so card stays visible while typing */
                position: sticky;
                top: 10px;
                z-index: 100;
                /* Add a subtle shadow/bg to separate sticky card from content */
                background: transparent; 
            }

            .card {
                box-shadow: 0 10px 25px rgba(0,0,0,0.15); /* Stronger shadow on mobile */
            }

            .control-panel {
                order: 2; /* Show Form Second */
                width: 100%; /* Full width form */
            }
        }

        /* Modal Styles */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center;
        }
        .modal-content {
            background: white; padding: 20px; border-radius: 8px; width: 95%; max-width: 500px;
        }
        .img-container { max-height: 50vh; margin-bottom: 20px; overflow: hidden; display: flex; justify-content: center; background: #f8fafc; }
        .img-container img { max-width: 100%; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 10px; }
        .btn-crop { background: #0f172a; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        .btn-cancel { background: #e2e8f0; color: #0f172a; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }

        @media print {
            body { background: white; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
            .control-panel { display: none; }
            .card-wrapper { transform: scale(1); margin: 0; padding: 0; position: static; }
            .card { box-shadow: none; border: 1px dashed #cccccc; }
        }
    </style>
</head>
<body>

    <div class="modal-overlay" id="cropperModal">
        <div class="modal-content">
            <h3>Adjust Photo</h3>
            <div class="img-container"><img id="imageToCrop" src="" alt="Crop"></div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="btn-crop" onclick="cropImage()">Crop & Save</button>
            </div>
        </div>
    </div>

    <div class="card-wrapper">
        <div class="card" id="myCard">
            <div class="header">
                <img src="https://images.racemate.in/assets/Website+Logo+Header-190x40+-+Black+Text.svg" alt="Logo" class="logo">
            </div>

            <div class="photo-wrapper">
                <div class="photo-frame">
                    <img src="https://img.freepik.com/free-photo/portrait-white-man-isolated_53876-40306.jpg" id="out_photo" alt="Profile" class="photo">
                </div>
            </div>

            <div class="content">
                <div class="name" id="out_name"></div>
                <div class="role-badge" id="out_role"></div>
                <div class="info-grid">
                    <div class="info-item"><span class="label">ID No.</span> <span class="value" id="out_id"></span></div>
                    <div class="info-item"><span class="label">Valid From</span> <span class="value" id="out_valid"></span></div>
                    <div class="info-item"><span class="label">Blood Grp</span> <span class="value" id="out_bg"></span></div>
                    <div class="info-item"><span class="label">Phone</span> <span class="value" id="out_phone"></span></div>
                </div>
            </div>

            <div class="footer-bg"></div>
            <div class="footer">
                <div class="qr-box"><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://racemateindia.com/" id="out_qr" alt="QR" class="qr-img"></div>
                
                <div class="company-details">
                    <div class="company-name" id="out_comp_name">RACEMATE INDIA PVT. LTD.</div>
                    <div class="company-address" id="out_comp_addr">RZ-8L/4, Indra Park,
Palam Colony, New Delhi</div>
                </div>
            </div>
        </div>
    </div>

    <div class="control-panel">
        <div class="input-group"><label>Employee Photo</label><input type="file" accept="image/*" onchange="loadPhoto(event)"></div>
        
        <div class="section-title">Employee Details</div>
        <div class="input-group"><label>Name</label><input type="text" id="in_name" value=""></div>
        <div class="input-group"><label>Designation</label><input type="text" id="in_role" value=""></div>
        <div class="input-group"><label>ID Number</label><input type="text" id="in_id" value="RMI-0"></div>
        <div class="input-group"><label>Blood Group</label><select id="in_bg"><option>O+</option><option>O-</option><option>B+</option><option>AB+</option></select></div>
        <div class="input-group"><label>Valid from</label><input type="text" id="in_valid" value=""></div>
        <div class="input-group"><label>Phone Number</label><input type="text" id="in_phone" value="+91 "></div>
        
        <div class="section-title">Company Info</div>
        <div class="input-group"><label>Company Name</label><input type="text" id="in_comp_name" value="RACEMATE INDIA PVT. LTD."></div>
        <div class="input-group"><label>Address</label><textarea id="in_comp_addr">RZ-8L/4, Indra Park,
Palam Colony, New Delhi</textarea></div>
        
        <button class="btn-update" onclick="updateCard()">Update Details</button>
        <button class="btn-print" onclick="window.print()">Print ID Card</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

    <script>
        // --- Photo Cropping Logic ---
        let cropper; 
        const modal = document.getElementById('cropperModal');
        const imageToCrop = document.getElementById('imageToCrop');

        function loadPhoto(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    imageToCrop.src = e.target.result;
                    modal.style.display = 'flex';
                    if (cropper) cropper.destroy();
                    cropper = new Cropper(imageToCrop, { aspectRatio: 1, viewMode: 1, autoCropArea: 0.8 });
                    event.target.value = '';
                };
                reader.readAsDataURL(file);
            }
        }
        function cropImage() {
            if (!cropper) return;
            const canvas = cropper.getCroppedCanvas({ width: 300, height: 300 });
            document.getElementById('out_photo').src = canvas.toDataURL();
            closeModal();
        }
        function closeModal() { modal.style.display = 'none'; if (cropper) { cropper.destroy(); cropper = null; } }

        function updateCard() {
            document.getElementById('out_name').innerText = document.getElementById('in_name').value;
            document.getElementById('out_role').innerText = document.getElementById('in_role').value;
            document.getElementById('out_id').innerText = document.getElementById('in_id').value;
            document.getElementById('out_bg').innerText = document.getElementById('in_bg').value;
            document.getElementById('out_valid').innerText = document.getElementById('in_valid').value;
            document.getElementById('out_phone').innerText = document.getElementById('in_phone').value;
            document.getElementById('out_comp_name').innerText = document.getElementById('in_comp_name').value;
            document.getElementById('out_comp_addr').innerText = document.getElementById('in_comp_addr').value;
        }
    </script>
</body>
</html>